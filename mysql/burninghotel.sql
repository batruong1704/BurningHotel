-- phpMyAdmin SQL Dump
-- version 5.2.1
-- https://www.phpmyadmin.net/
--
-- Máy chủ: 127.0.0.1
-- Thời gian đã tạo: Th10 28, 2023 lúc 05:39 PM
-- Phiên bản máy phục vụ: 10.4.28-MariaDB
-- Phiên bản PHP: 8.2.4

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Cơ sở dữ liệu: `burninghotel`
--

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `chitietdatmon`
--
-- Error reading structure for table burninghotel.chitietdatmon: #1932 - Table &#039;burninghotel.chitietdatmon&#039; doesn&#039;t exist in engine
-- Error reading data for table burninghotel.chitietdatmon: #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#039;FROM `burninghotel`.`chitietdatmon`&#039; at line 1

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `chitietdatphong`
--
-- Error reading structure for table burninghotel.chitietdatphong: #1932 - Table &#039;burninghotel.chitietdatphong&#039; doesn&#039;t exist in engine
-- Error reading data for table burninghotel.chitietdatphong: #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#039;FROM `burninghotel`.`chitietdatphong`&#039; at line 1

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `chitietdichvu`
--
-- Error reading structure for table burninghotel.chitietdichvu: #1932 - Table &#039;burninghotel.chitietdichvu&#039; doesn&#039;t exist in engine
-- Error reading data for table burninghotel.chitietdichvu: #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#039;FROM `burninghotel`.`chitietdichvu`&#039; at line 1

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `daubep`
--
-- Error reading structure for table burninghotel.daubep: #1932 - Table &#039;burninghotel.daubep&#039; doesn&#039;t exist in engine
-- Error reading data for table burninghotel.daubep: #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#039;FROM `burninghotel`.`daubep`&#039; at line 1

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `dichvu`
--
-- Error reading structure for table burninghotel.dichvu: #1932 - Table &#039;burninghotel.dichvu&#039; doesn&#039;t exist in engine
-- Error reading data for table burninghotel.dichvu: #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#039;FROM `burninghotel`.`dichvu`&#039; at line 1

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `doan`
--
-- Error reading structure for table burninghotel.doan: #1932 - Table &#039;burninghotel.doan&#039; doesn&#039;t exist in engine
-- Error reading data for table burninghotel.doan: #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#039;FROM `burninghotel`.`doan`&#039; at line 1

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `hoadon`
--
-- Error reading structure for table burninghotel.hoadon: #1932 - Table &#039;burninghotel.hoadon&#039; doesn&#039;t exist in engine
-- Error reading data for table burninghotel.hoadon: #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#039;FROM `burninghotel`.`hoadon`&#039; at line 1

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `monan`
--
-- Error reading structure for table burninghotel.monan: #1932 - Table &#039;burninghotel.monan&#039; doesn&#039;t exist in engine
-- Error reading data for table burninghotel.monan: #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#039;FROM `burninghotel`.`monan`&#039; at line 1

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `phieudatphong`
--
-- Error reading structure for table burninghotel.phieudatphong: #1932 - Table &#039;burninghotel.phieudatphong&#039; doesn&#039;t exist in engine
-- Error reading data for table burninghotel.phieudatphong: #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#039;FROM `burninghotel`.`phieudatphong`&#039; at line 1

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `phieudichvu`
--
-- Error reading structure for table burninghotel.phieudichvu: #1932 - Table &#039;burninghotel.phieudichvu&#039; doesn&#039;t exist in engine
-- Error reading data for table burninghotel.phieudichvu: #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#039;FROM `burninghotel`.`phieudichvu`&#039; at line 1

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `phieugiamgia`
--
-- Error reading structure for table burninghotel.phieugiamgia: #1932 - Table &#039;burninghotel.phieugiamgia&#039; doesn&#039;t exist in engine
-- Error reading data for table burninghotel.phieugiamgia: #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#039;FROM `burninghotel`.`phieugiamgia`&#039; at line 1

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `phong`
--
-- Error reading structure for table burninghotel.phong: #1932 - Table &#039;burninghotel.phong&#039; doesn&#039;t exist in engine
-- Error reading data for table burninghotel.phong: #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#039;FROM `burninghotel`.`phong`&#039; at line 1

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `quanlytaikhoan`
--
-- Error reading structure for table burninghotel.quanlytaikhoan: #1932 - Table &#039;burninghotel.quanlytaikhoan&#039; doesn&#039;t exist in engine
-- Error reading data for table burninghotel.quanlytaikhoan: #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#039;FROM `burninghotel`.`quanlytaikhoan`&#039; at line 1

-- --------------------------------------------------------

--
-- Cấu trúc bảng cho bảng `taikhoanadmin`
--
-- Error reading structure for table burninghotel.taikhoanadmin: #1932 - Table &#039;burninghotel.taikhoanadmin&#039; doesn&#039;t exist in engine
-- Error reading data for table burninghotel.taikhoanadmin: #1064 - You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#039;FROM `burninghotel`.`taikhoanadmin`&#039; at line 1

DELIMITER $$
--
-- Sự kiện
--
CREATE DEFINER=`root`@`localhost` EVENT `CapNhapTrangThaiHoaDon` ON SCHEDULE EVERY 1 SECOND STARTS '2023-10-28 22:38:43' ON COMPLETION NOT PRESERVE ENABLE DO UPDATE hoadon AS hd
  JOIN chitietdatphong AS ctdp
  ON hd.MaPDP = ctdp.MaPDP
  SET hd.TinhTrang = 
  CASE
    WHEN ctdp.NgayDen <= NOW() AND ctdp.NgayDi >= NOW() THEN 'Chờ thanh toán'
    WHEN ctdp.NgayDi < NOW() THEN 'Đã thanh toán'
  END
  Where hd.TinhTrang IN ('Đã đặt cọc', 'Chờ thanh toán')$$

DELIMITER ;
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
